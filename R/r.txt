# Make sure you have these packages installed
install.packages('ggplot2')
install.packages('plyr')

# Include libraries
library(ggplot2)
library(plyr)

# Read your data generated by hbase-rest-stats.py here.
data <- read.csv('/Users/jeremycarroll/data.csv', header=TRUE)

# Generate aggregates
table_balance <- ddply(subset(data, table != 'ROOT' & table != 'META'), c('server', 'table'), function(x) c(count=nrow(x)))
server_balance <- ddply(data, c('server'), function(x) c(count=nrow(x)))

# Render Region Distribution
ggplot(server_balance,aes(x=server,y=count,fill=count)) + geom_bar() + theme_bw() + labs(title="Region Distribution", y='regions')  + opts(legend.position="none") + opts(axis.text.x = theme_text(angle = 90, hjust = 0))

# Render Region Distribution per Table
ggplot(table_balance,aes(x=server,y=count,fill=count)) + geom_bar(stat="identity") + theme_bw() + labs(title="Region Distribution", y='regions')  + opts(legend.position="none") + opts(axis.text.x = theme_text(angle = 90, hjust = 0)) + scale_fill_gradient("Count", low = "#102E37", high = "#2BBBD8") + facet_wrap(~table, scales="free")

